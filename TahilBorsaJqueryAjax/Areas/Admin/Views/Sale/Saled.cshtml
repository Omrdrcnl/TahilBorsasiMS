@{
    ViewData["Title"] = "Saled";
    Layout = "~/Views/Shared/Layout.cshtml";
}

<div class="container mt-5">
    <h2 class="m-auto mb-3">Gerçekleşen Satışlar</h2>
    @using (Html.BeginForm("Saled", "Sale", FormMethod.Get))
    {
        <div class="form-control input-group row-cols-md-6 align-items-center">
            <div class="col-md-4">   @Html.TextBox("e", null, new { @class = "form-control", placeholder = "Çiftçi Kimlik No Ara" })</div>
            <div class="col-md-2">  <button class="btn btn-outline-primary">Ara</button></div>
        </div>
    }
    @using (Html.BeginForm("Index", "Sale", FormMethod.Get))

    {
        <div>
            <table id="Saled" class="table table-bordered table-hover table-success table-striped">
                <tr class="table-warning">
                    <th>Satış No</th>
                    <th>Giriş No</th>
                    <th>Alıcı</th>
                    <th>Satıcı</th>
                    <th>Çiftçi Kimlik no</th>
                    <th>Ürün</th>
                    <th>Miktar Kg</th>
                    <th>Besin Değeri</th>
                    <th class="text-center">İşlem</th>

                </tr>
                <tbody>
                </tbody>
            </table>
        </div>
        <div class="btn-group btn-group-lg d-flex justify-content-between">
            <div>
                <a href="/Sale/Index/" class="btn btn-primary btn-lg">Geri</a>
            </div>

        </div>

    }

</div>


<script>
    function getSaledList() {

        fetchData("Sale/SaledList", function (response) {

            console.log("SaledList data", response);


            var tbody = $("#Saled tbody");

            $.each(response, function (index, t) {
                var row = $("<tr>");
                row.append($("<td>").text(t.saleId));
                row.append($("<td>").text(t.entryId));
                row.append($("<td>").text(`${t.farmerFirstName} ${t.farmerLastName}`));
                row.append($("<td>").text(`${t.trFirstName} ${t.trLastName}`));
                row.append($("<td>").text(t.farmerIdentityNo));
                row.append($("<td>").text(t.productName));
                row.append($("<td>").text(t.quantity));
                row.append($("<td>").text(t.nutritionalValue));
                row.append($("<td>").html(`<button data-bs-toggle="modal" data-bs-target="#rolModal" onClick="EnterSale(

                                                                         '${t.entryId}',
                                                                         '${t.productName}',
                                                                         '${t.nutritionalValue}',
                                                                             '${t.saleId}',
                                                                             '${t.labId}'
                                                                    )" class="btn btn-success">Detay</button>
                                                                    `));

                tbody.append(row);
            });

        });
    }

    $(document).ready(function () {
        getSaledList();
    })

</script>